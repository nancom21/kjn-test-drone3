kind: pipeline
type: docker
name: default

steps:
- name: build
  image: golang:1.13
  commands:
  - uname -a
  - echo world
  - echo test1234
  - ls -al 

- name: slack
  image: plugins/slack
  settings:
    webhook:
      from_secret: https://hooks.slack.com/services/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
    channel: naver-kjn-drone
    username: drone
    template: >
      {{#success build.status}}
        build {{build.number}} status: *{{build.status}}*
        build link: {{build.link}}
        build author: {{build.author}}
        build ref: {{build.ref}}
        build event: {{build.event}}
        build commit: {{build.commit}}
        build branch: {{build.branch}}
        build deploy: {{build.deployTo}}
      {{else}}
        build {{build.number}} failed. Fix me please.
      {{/success}}

- name: publish
  image: plugins/docker
  settings:
    username: 
      from_secret: docker_username
    password:
      from_secret: docker_password
    repo: nancom21/testpublic
#    repo: nancom21/kjn-test-drone3
    auto_tag: true
    auto_tag_suffix: drone-build


